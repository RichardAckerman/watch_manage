"use strict";function bd09togcj02(e,n){var o=52.35987755982988,t=e-.0065,i=n-.006,r=Math.sqrt(t*t+i*i)-2e-5*Math.sin(i*o),s=Math.atan2(i,t)-3e-6*Math.cos(t*o);return[r*Math.cos(s),r*Math.sin(s)]}function gcj02tobd09(e,n){var o=Math.sqrt(e*e+n*n)+2e-5*Math.sin(n*x_PI),t=Math.atan2(n,e)+3e-6*Math.cos(e*x_PI);return[o*Math.cos(t)+.0065,o*Math.sin(t)+.006]}function wgs84togcj02(e,n){if(out_of_china(e,n))return[e,n];var o=transformlat(e-105,n-35),t=transformlng(e-105,n-35),i=n/180*PI,r=Math.sin(i);r=1-ee*r*r;var s=Math.sqrt(r);return o=180*o/(a*(1-ee)/(r*s)*PI),[e+(t=180*t/(a/s*Math.cos(i)*PI)),n+o]}function gcj02towgs84(e,n){if(out_of_china(e,n))return[e,n];var o=transformlat(e-105,n-35),t=transformlng(e-105,n-35),i=n/180*PI,r=Math.sin(i);r=1-ee*r*r;var s=Math.sqrt(r);return o=180*o/(a*(1-ee)/(r*s)*PI),t=180*t/(a/s*Math.cos(i)*PI),mglat=n+o,mglng=e+t,[2*e-mglng,2*n-mglat]}function transformlat(e,n){var o=2*e-100+3*n+.2*n*n+.1*e*n+.2*Math.sqrt(Math.abs(e));return o+=2*(20*Math.sin(6*e*PI)+20*Math.sin(2*e*PI))/3,o+=2*(20*Math.sin(n*PI)+40*Math.sin(n/3*PI))/3,o+=2*(160*Math.sin(n/12*PI)+320*Math.sin(n*PI/30))/3}function transformlng(e,n){var o=300+e+2*n+.1*e*e+.1*e*n+.1*Math.sqrt(Math.abs(e));return o+=2*(20*Math.sin(6*e*PI)+20*Math.sin(2*e*PI))/3,o+=2*(20*Math.sin(e*PI)+40*Math.sin(e/3*PI))/3,o+=2*(150*Math.sin(e/12*PI)+300*Math.sin(e/30*PI))/3}function out_of_china(e,n){return e<72.004||e>137.8347||n<.8293||n>55.8271||!1}function InfoBox(e){e=e||{},google.maps.OverlayView.apply(this,arguments),this.content_=e.content||"",this.disableAutoPan_=e.disableAutoPan||!1,this.maxWidth_=e.maxWidth||0,this.pixelOffset_=e.pixelOffset||new google.maps.Size(0,0),this.position_=e.position||new google.maps.LatLng(0,0),this.zIndex_=e.zIndex||null,this.boxClass_=e.boxClass||"infoBox",this.boxStyle_=e.boxStyle||{},this.closeBoxMargin_=e.closeBoxMargin||"2px",this.closeBoxURL_=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===e.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=e.infoBoxClearance||new google.maps.Size(1,1),this.isHidden_=e.isHidden||!1,this.alignBottom_=e.alignBottom||!1,this.pane_=e.pane||"floatPane",this.enableEventPropagation_=e.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.moveListener_=null,this.contextListener_=null,this.fixedWidthSet_=null}var app=angular.module("watchApp",["ngRoute","ngCookies","watchApp.editUserInfo","watchApp.personal","watchApp.head","watchApp.password","watchApp.customer","watchApp.position","watchApp.version","watchApp.api","watchApp.service","watchApp.login","watchApp.updateEquip","watchApp.searchEquips","watchApp.searchCustomers","watchApp.addEquip","watchApp.addCustomer","watchApp.showCustomer","watchApp.transferCustomer","watchApp.rightMenu","watchApp.baiduMap","watchApp.moveEquip","watchApp.googleMap","watchApp.confirm"]);app.config(["$locationProvider","$routeProvider",function(e,n){e.hashPrefix("!"),n.otherwise({redirectTo:"/login"})}]),app.directive("loading",function(){return{restrict:"E",transclude:!0,template:'<div class="divModal">\n                        <p class="loadingFont">加载中,请稍等···</p>\n                    </div>',link:function(e,n,o){e.$watch("loading",function(e){e?$(n).show():$(n).hide()})}}});var addCustomer=angular.module("watchApp.addCustomer",[]);addCustomer.controller("addCustomerCtrl",["$scope","dealer","errorMsg","closeWind","pathLogin",function(e,n,o,t,i){e.warnMsg=!0,e.sucMsg=!0,e.$on("superiorInfo",function(n,o){e.superiorId=o.id}),e.addCustomer=function(){if(void 0===e.userName||""===e.userName)return e.warnMessage=o.emptyUserName,e.warnMsg=!1,void t.close(".notice",e);if(!/^[\u4e00-\u9fa5a-zA-Z0-9_]{1,10}$/g.test(e.userName))return e.warnMessage=o.registerMsg.name,e.warnMsg=!1,void t.close(".notice",e);if(!/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(e.email)||void 0===e.email||""===e.email)return e.warnMessage=o.email,e.warnMsg=!1,void t.close(".notice",e);if(void 0===e.password||""===e.password)return e.warnMessage=o.password.required,e.warnMsg=!1,void t.close(".notice",e);if(e.password!==e.affirm)return e.warnMessage=o.password.diff,e.warnMsg=!1,void t.close(".notice",e);var r=/^1[3|4|5|8][0-9]\d{8}$/g;if(""!==e.phone&&void 0!==e.phone&&!r.test(e.phone))return e.warnMessage=o.phoneError,e.warnMsg=!1,void t.close(".notice",e);var s={userName:e.userName,email:e.email,psw:e.password,superiorId:e.superiorId,type:2,linkman:e.linkman,dealerPhone:e.phone,dealerAddress:e.address};n.addCus(s).success(function(n){200===n.code&&void 0!==n.result?(t.close("#addCustomer",e),n.sign=n.successful,e.$emit("transformEquip",n)):408===n.code?(e.warnMessage=o.loginGetaway,t.close("#addCustomer",e),i.path(e)):(e.warnMessage=n.msg,e.warnMsg=!1,t.close("#addCustomer",e))}).error(function(){e.warnMessage=o.serviceException,e.warnMsg=!1,t.close("#addCustomer",e)})}}]);var addEquip=angular.module("watchApp.addEquip",[]);addEquip.controller("addEquipCtrl",["$scope","$rootScope","library","closeWind","pathLogin","errorMsg",function(e,n,o,t,i,r){e.warnMsg=!0,e.sucMsg=!0,e.$on("superiorInfo",function(n,o){e.dealerInfo=o}),e.addEquip=function(){if(!/(^[\d]{10}$)|(^[\d]{15}$)/g.test(e.imei))return e.warnMessage=r.imeiError.imeiFormat,e.warnMsg=!1,t.close(".notice",e),!1;var n={imei:e.imei,dealerId:e.dealerInfo.id,superiorId:e.dealerInfo.superiorId};o.put(n).success(function(n){200===n.code?(e.successMessage=n.msg,e.sucMsg=!1,e.$emit("addEquip",n.result)):408===n.code?(e.warnMessage=r.loginGetaway,i.path(e)):(e.warnMessage=n.msg,e.warnMsg=!1),t.close("#addEquip",e)}).error(function(){e.warnMessage=r.serviceException,e.warnMsg=!1,t.close("#addEquip",e)})}}]);var api=angular.module("watchApp.api",[]),TEST="http://127.0.0.1:8080/watch",PRODUCT="https://so360.org/watch",HOST=PRODUCT,API_LOGIN=HOST+"/adminSignIn",API_LOGOUT=HOST+"/logOut",API_INDEX_DATA=HOST+"/admin/adminIndexView",API_UPDATE_PASSWORD=HOST+"/admin/password",API_UPDATE_USER_INFO=HOST+"/admin/userInfo",API__EQUIP=HOST+"/admin/library",API__EQUIP_ID=API__EQUIP+"/id/",API__EQUIP_IMEI=API__EQUIP+"/imei/",API__EQUIP_NAME=HOST+"/admin/equip/name/",API_EQUIP_PAGE=HOST+"/admin/libraries",API_EQUIP_DETAIL=HOST+"/admin/allEquipInfo/superiorId/",API_DELETE_BATCH=API__EQUIP+"/remove/batch",API_DEALER=HOST+"/admin/dealer",API_DEALER_ID=HOST+"/admin/library/user/dealerId/",API_DEALER_EMAIL=HOST+"/admin/library/user/emailOrUserName",API_DEALER_UPDATE=HOST+"/admin/dealer/",API__EQUIP_TRANSFORM=API__EQUIP+"/move",API__EQUIP_BATCH=API__EQUIP_TRANSFORM+"/batch",API_POSITION_EMAIL=HOST+"/admin/equipInfo/info",API_POSITION_IMEI=HOST+"/admin/equipInfo/imei/",API_POSITION_NAME=HOST+"/admin/equipInfo/name/",API_RESET_PHONE=HOST+"/admin/reset/userPhone/";api.config(["$httpProvider",function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",e.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded",e.defaults.headers.patch["Content-Type"]="application/x-www-form-urlencoded",e.defaults.withCredentials=!0,e.defaults.transformRequest=[function(n){return e.defaults.paramSerializer(n)}]}]),api.factory("authService",["$http",function(e){return{signIn:function(n){return e({url:API_LOGIN,method:"POST",cache:!0,data:n})},oAuth:function(n){return e({url:API_LOGIN,method:"POST",data:n})},signOut:function(){return e({url:API_LOGOUT,method:"POST"})}}}]),api.factory("indexService",["$http",function(e){return{indexData:function(){return e({url:API_INDEX_DATA,method:"GET"})}}}]),api.factory("password",["$http",function(e){return{updatePassword:function(n){return e({url:API_UPDATE_PASSWORD,method:"POST",data:n})}}}]),api.factory("userInfo",["$http",function(e){return{update:function(n){return e({url:API_UPDATE_USER_INFO,method:"PATCH",data:n})},updateSubordinate:function(n){return e({url:API_UPDATE_USER_INFO,method:"POST",data:n})}}}]),api.factory("library",["$http",function(e){return{queryByImei:function(n){return e({url:API__EQUIP_IMEI+n,method:"GET"})},queryByName:function(n){return e({url:API__EQUIP_NAME+n,method:"GET"})},queryById:function(n){return e({url:API__EQUIP_ID+n,method:"GET"})},queryPage:function(n){return e({url:API_EQUIP_PAGE,method:"GET",params:n})},put:function(n){return e({url:API__EQUIP,method:"PUT",data:n})},update:function(n){return e({url:API__EQUIP,method:"PATCH",data:n})},delete:function(n){return e({url:API__EQUIP_ID+n,method:"DELETE"})},batchDelete:function(n){return e({url:API_DELETE_BATCH,method:"POST",data:n})},transform:function(n){return e({url:API__EQUIP_TRANSFORM,method:"POST",data:n})},batchTransform:function(n){return e({url:API__EQUIP_BATCH,method:"POST",data:n})},resetPhone:function(n){return e({url:API_RESET_PHONE+n,method:"DELETE"})}}}]),api.factory("dealer",["$http",function(e){return{addCus:function(n){return e({url:API_DEALER,method:"POST",data:n})},delCus:function(n){return e({url:API_DEALER_UPDATE+n,method:"DELETE"})},resetPwd:function(n){return e({url:API_DEALER_UPDATE+n,method:"PATCH"})},queryById:function(n){return e({url:API_DEALER_ID+n,method:"GET"})},queryByEmail:function(n){return e({url:API_DEALER_EMAIL,method:"GET",params:n})}}}]),api.factory("location",["$http",function(e){return{queryEquipNum:function(n){return e({url:API_EQUIP_DETAIL+n,method:"GET"})},queryByEmail:function(n){return e({url:API_POSITION_EMAIL,method:"GET",params:n})},queryByImei:function(n){return e({url:API_POSITION_IMEI+n,method:"GET"})},queryByName:function(n){return e({url:API_POSITION_NAME+n,method:"GET"})}}}]);var service=angular.module("watchApp.service",[]);service.factory("uuid",function(){return md5((new Date).getTime(),Math.random())}),service.value("errorMsg",{password:{required:"密码不能为空",diff:"两次数据密码不同",same:"新旧密码相同"},imeiError:{imeiEmpty:"请输入IMEI号",imeiFormat:"请输入10位或15位IMEI号",name:"设备名不能是纯数字"},loginGetaway:"登录过期,请再次登录!",serviceException:"服务器异常,请联系管理员!",abnormalPermissions:"权限不符",queryEmpty:"未查询到相应数据!",email:"邮箱格式错误",noChoose:"请先选择",aimEmpty:"目标客户不能为空!",equipEmpty:"请选择转移设备!",duplication:"不能转移给自己",emptyUserName:"请输入客户名称",phoneError:"电话号码格式不对",delFail:"不能删除该客户!请先转移设备后再试!",registerMsg:{name:"用户名仅支持中英文、数字和下划线,且不能超过10个字符"}}),service.value("ordinaryMsg",{myInfo:"我的信息",customerInfo:"客户信息",undefinedInfo:"未填写",emptyInfo:"查询条件不能为空!",inactive:"未激活",deleteInfo:{success:"删除成功",failure:"删除失败"}}),service.service("closeWind",["$timeout",function(e){var n=null,o=function(o,t){n=e(function(){t.warnMsg=!0,t.sucMsg=!0,angular.element(o).modal("hide")},1500)};this.close=function(e,n){o(e,n)},this.cancel=function(){e.cancel(n)}}]),service.service("pathLogin",["$timeout","$location",function(e,n){var o=null,t=function(t){o=e(function(){t.warnMsg=!0,t.sucMsg=!0,n.path("/login")},2e3)};this.path=function(e){t(e)},this.cancel=function(){e.cancel(o)}}]),service.service("reloadRoute",["$timeout","$window",function(e,n){var o=null,t=function(t){o=e(function(){t.warnMsg=!0,t.sucMsg=!0,n.location.reload()},2e3)};this.path=function(e){t(e)},this.cancel=function(){e.cancel(o)}}]),service.service("loginGetaway",["$location",function(e){this.goLogin=function(){e.path("/login")}}]),service.factory("confirmService",["$modal","$q",function(e,n){return{openConfirmWindow:function(o,t){var i=n.defer(),r=e.open({templateUrl:"confirm/myModelContent.html",controller:"ModalInstanceCtrl",size:"sm",resolve:{data:function(){return{modalContent:t}}}});return r.result.then(function(){r&&r.dismiss("cancel"),i.resolve()},function(){}),i.promise}}}]);var confirm=angular.module("watchApp.confirm",["ui.bootstrap"]);confirm.controller("ModalInstanceCtrl",["$scope","$modalInstance","data",function(e,n,o){e.modalContent=o.modalContent,e.ok=function(){n.close()},e.cancel=function(){n.dismiss("cancel")}}]);var customer=angular.module("watchApp.customer",["ngRoute"]);customer.config(["$routeProvider",function(e){e.when("/customer",{templateUrl:"customer/customer.html"})}]),customer.directive("contextmenu",["$filter",function(e){return{restrict:"A",link:function(n,o,t){var i=angular.element("#rightMenu");o.bind("contextmenu",function(o){n.$emit("dealerInfoRM",n.subordinateDealer),n.listActive(e("integer")(t.index)),n.$apply(function(){o.stopPropagation(),o.preventDefault(),n.$parent.rightMenuHide=!1,i.css("top",o.clientY+"px"),i.css("left",o.clientX+"px")})})}}}]),customer.controller("customerCtrl",["$rootScope","$scope","indexService","loginGetaway","dealer","pathLogin","confirmService","library","errorMsg","ordinaryMsg","$window","$filter","closeWind","$timeout",function(e,n,o,t,i,r,s,a,u,l,c,d,p,m){n.isAdmin=!1,n.isActive=1,n.pageIsActive=1,n.allPageSize=[10,20,30,40,50,100],n.pageSize="10",n.pages=[],n.rightMenuHide=!0,n.userList=!0,angular.element(c).on("click",function(){n.$apply(function(){n.userList=!0,n.rightMenuHide=!0})}),o.indexData().success(function(o){if(200===o.code){var i=o.result;if(n.messageType=l.customerInfo,e.userAdmin=i.userInfoDTO,n.userDealer=i.userInfoDTO,e.userEquipNum=0,void 0!==i.dealerInfoVos){var r=i.dealerInfoVos;n.count=r.count,n.equips=r.result,angular.forEach(n.equips,function(e,n){e.isChecked=!1}),e.userEquipNum=r.count,n.userDealer.equipNum=e.userEquipNum,n.allPageNum=r.pages,n.pages=new Array(r.pages)}1===i.userInfoDTO.id&&(n.isAdmin=!0),n.subordinateDealers=i.subordinateDealers,n.$broadcast("allUserInfo",n.subordinateDealers),n.$broadcast("superiorInfo",n.userDealer)}if(408===o.code){n.msgModal=u.serviceException,angular.element(".bs-example-modal-sm").modal("toggle");var s=m(function(){m.cancel(s),angular.element(".bs-example-modal-sm").modal("hide");var e=m(function(){m.cancel(e),t.goLogin()},2e3)},3e3)}if(409===o.code){n.msgModal="Abnormal permissions!"===o.msg?u.abnormalPermissions:u.serviceException,angular.element(".bs-example-modal-sm").modal("toggle");var a=m(function(){m.cancel(a),angular.element(".bs-example-modal-sm").modal("hide");var e=m(function(){m.cancel(e),t.goLogin()},2e3)},3e3)}}).error(function(){t.goLogin()}),n.singleClick=function(){n.equipAll=!0,angular.forEach(n.equips,function(e,o){n.equipAll=e.isChecked&&n.equipAll})},n.allChecked=function(){angular.forEach(n.equips,function(e,o){e.isChecked=n.equipAll})},n.pagingQuery=function(e){n.getEquipByPage(n.pageSize,e)},n.getEquipByPage=function(o,i){var r={pageSize:o,pageNum:i||1,dealerId:n.userDealer.id};a.queryPage(r).success(function(o){200===o.code&&(n.equips=o.result,n.pageIsActive=r.pageNum,r.dealerId===e.userAdmin.id?n.pages=new Array(d("ceil")(e.userEquipNum/n.pageSize)):n.subordinateDealers.forEach(function(e,o){if(d("ceil")(e.userId)===d("ceil")(r.dealerId)){var t=e.equipNum;n.pages=new Array(d("ceil")(t/n.pageSize))}}),n.equipAll=!1),408===o.code&&t.goLogin()}).error(function(){n.msgModal=u.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")})},n.prevClick=function(){n.pageIsActive>1&&n.getEquipByPage(n.pageSize,n.pageIsActive-1)},n.nextClick=function(){n.pageIsActive<n.pages.length&&n.getEquipByPage(n.pageSize,n.pageIsActive+1)},n.pageSizeChg=function(){n.getEquipByPage(n.pageSize,1)},n.$on("dealerData",function(o,t){n.subordinateDealers.forEach(function(e,n){d("integer")(e.userId)===d("integer")(t.id)&&(e.userName=t.userName)}),n.userDealer.userName=t.userName,n.userDealer.linkman=t.linkman,n.userDealer.dealerPhone=t.dealerPhone,n.userDealer.dealerAddress=t.dealerAddress,d("integer")(t.id)===d("integer")(n.userAdmin.id)&&(e.userAdmin.userName=t.userName)}),n.$on("equipData",function(e,o){n.equips.forEach(function(e,t){e.id===o.id&&(o.createTime=e.createTime,o.activationTime=e.activationTime,n.equips[t]=o)})}),n.$on("addEquip",function(o,t){t.isChecked=!1,n.equips.unshift(t),e.userEquipNum++,1===n.isActive&&(n.userDealer.equipNum=e.userEquipNum)}),n.$on("modalTransfer",function(e,o){n.userList=!1;var t=angular.element("#transferCustomer"),i=t.width();t.css({top:o.event.clientY+"px",left:o.event.clientX-i+"px",zIndex:1100}),n.$broadcast("transformInfo",{equipId:o.id,userId:n.userDealer.id})}),n.$on("delMsg",function(e,o){n.msgModal=o.msg,n.equips.forEach(function(e,t,i){e.id===o.id&&(i.splice(t,1),n.equips=i)})}),n.$on("searchEquip",function(e,o){n.equip=o}),n.$on("transformEquip",function(e,o){n.msgModal=o.msg,o.sign&&n.updateDealer(o),p.close("#searchEquips",n),angular.element(".bs-example-modal-sm").modal("toggle")}),n.$on("batchTrans",function(e,o){n.$broadcast("batchTransModal",o)}),n.$on("showCusInfo",function(n,o){e.$broadcast("customerInfo",o)}),n.$on("dealerInfoRM",function(e,o){n.$broadcast("dealerMsg",o)}),n.$on("dealerInfoChange",function(o,t){n.subordinateDealers.forEach(function(e,n){d("integer")(e.userId)===d("integer")(t.id)&&(e.userName=t.userName)}),e.userAdmin.email===t.email&&(e.userAdmin.userName=t.userName),t.email===n.userDealer.email&&(n.userDealer.userName=t.userName,n.userDealer.linkman=t.linkman,n.userDealer.dealerPhone=t.dealerPhone,n.userDealer.dealerAddress=t.dealerAddress)}),n.addCustomer=function(){angular.element("#addCustomer").modal("toggle")},n.addEquip=function(){angular.element("#addEquip").modal("toggle")},n.transferCustomer=function(e,o){e.stopPropagation(),n.userList=!1;var t=angular.element("#transferCustomer"),i=t.width();t.css("top",e.clientY+"px"),t.css("left",e.clientX-i+"px"),n.$broadcast("transformInfo",{equipId:o,userId:n.userDealer.id})},n.showTransWindow=function(e){n.userList=!1;var o=angular.element("#transferCustomer"),t=o.width();o.css({top:e.clientY+"px",left:e.clientX-t+"px",zIndex:1100})},n.updateEquip=function(e){angular.element("#updateEquip").modal("toggle"),n.equip=e},n.removeEquip=function(e){s.openConfirmWindow(n,"确认删除吗？").then(function(){a.delete(e).success(function(o){200===o.code?(n.msgModal=l.deleteInfo.success,n.updateDealer({ids:[e]}),angular.element(".bs-example-modal-sm").modal("toggle")):408===o.code?t.goLogin():(n.msgModal=l.deleteInfo.failure,angular.element(".bs-example-modal-sm").modal("toggle"))}).error(function(){n.msgModal=u.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")})})},n.moveEquip=function(){var e=[];if(void 0===n.equips)return!1;n.equips.forEach(function(n,o,t){!0===n.isChecked&&e.push(n)}),n.$broadcast("batchEquipsInfo",{equips:e,userId:n.userDealer.id}),angular.element("#moveEquip").modal("toggle")},n.delInBatch=function(){var e={ids:[]};if(void 0===n.equips)return!1;if(n.equips.forEach(function(n,o,t){!0===n.isChecked&&e.ids.push(n.id)}),0===e.ids.length)return n.msgModal=u.noChoose,angular.element(".bs-example-modal-sm").modal("toggle"),!1;s.openConfirmWindow(n,"确认删除吗？").then(function(){a.batchDelete(e).success(function(o){200===o.code?n.updateDealer(e):408===o.code&&r.path(n),n.msgModal=o.msg,angular.element(".bs-example-modal-sm").modal("toggle")}).error(function(){n.msgModal=u.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")})})},n.searchCustomers=function(){if(void 0===n.searchParams||""===n.searchParams)return n.msgModal=l.emptyInfo,void angular.element(".bs-example-modal-sm").modal("toggle");var e={info:n.searchParams};i.queryByEmail(e).success(function(o){200===o.code&&void 0!==o.result?(o.result.queryType=-1===e.info.indexOf("@")?"name":"email",n.$broadcast("myCustomerInfo",o.result),angular.element("#searchCustomers").modal("toggle")):408===o.code?r.path(n):(n.msgModal=o.result?o.msg:u.queryEmpty,angular.element(".bs-example-modal-sm").modal("toggle"))}).error(function(){n.msgModal=u.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")})},n.searchEquips=function(){if(void 0===n.searchParams||""===n.searchParams)return n.msgModal=l.emptyInfo,void angular.element(".bs-example-modal-sm").modal("toggle");/(^[\d]{10}$)|(^[\d]{15}$)/g.test(n.searchParams)?a.queryByImei(n.searchParams).success(function(e){200===e.code&&void 0!==e.result?(e.result.queryType="imei",n.$broadcast("equipInfo",e.result),angular.element("#searchEquips").modal("toggle")):408===e.code?r.path(n):(n.msgModal=e.result?e.msg:u.queryEmpty,angular.element(".bs-example-modal-sm").modal("toggle"))}).error(function(){n.msgModal=u.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")}):a.queryByName(n.searchParams).success(function(e){200===e.code&&void 0!==e.result?(e.result.queryType="name",n.$broadcast("equipInfo",e.result),angular.element("#searchEquips").modal("toggle")):408===e.code?r.path(n):(n.msgModal=e.result?e.msg:u.queryEmpty,angular.element(".bs-example-modal-sm").modal("toggle"))}).error(function(){n.msgModal=u.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")})},n.superiorSelected=function(){n.isActive=1,n.dealerActive=void 0,n.userDealer=e.userAdmin,n.userDealer.equipNum=e.userEquipNum,n.getEquipByPage(n.pageSize)},n.listActive=function(e){n.isActive=0,n.dealerActive=e,n.queryInfoByEmail(n.subordinateDealers[e].email,n.subordinateDealers[e].equipNum)},n.queryInfoByEmail=function(e,o){var t={info:e};i.queryByEmail(t).success(function(e){200===e.code&&void 0!==e.result?(n.userDealer=e.result,n.userDealer.equipNum=o,n.getEquipByPage(n.pageSize)):408===e.code?(n.warnMessage=u.loginGetaway,r.path(n)):(n.warnMessage=e.result?e.msg:u.queryEmpty,n.warnMsg=!1)}).error(function(){n.warnMessage=u.serviceException,n.warnMsg=!1})},n.updateDealer=function(i){o.indexData().success(function(o){if(200===o.code){var t=o.result;if(e.userEquipNum=t.dealerInfoVos.count,n.subordinateDealers=t.subordinateDealers,n.$broadcast("allUserInfo",n.subordinateDealers),void 0!==n.subordinateDealers&&n.subordinateDealers.forEach(function(e,o){d("integer")(e.userId)===d("integer")(n.userDealer.id)&&(n.userDealer.equipNum=e.equipNum)}),"delCus"===i.func&&(n.userDealer=void 0),void 0===i.ids)return!1;var r=[],s=[];i.ids.forEach(function(e,n){s[e]=!0}),n.equips.forEach(function(e,n,o){s[e.id]||r.push(e)}),n.equips=r}}).error(function(){t.goLogin()})}}]),customer.filter("blank",["ordinaryMsg",function(e){return function(n){return void 0===n||""===n?e.undefinedInfo:n}}]),customer.filter("inactive",["ordinaryMsg",function(e){return function(n,o){return 0===o?e.inactive:void 0===n||""===n?e.undefinedInfo:n}}]),customer.filter("ceil",function(){return function(e){return Math.ceil(e)}}),customer.filter("integer",function(){return function(e){return parseInt(e)}});var editUserInfo=angular.module("watchApp.editUserInfo",[]);editUserInfo.controller("editUserInfoCtrl",["$scope","$rootScope","userInfo","closeWind","pathLogin","errorMsg",function(e,n,o,t,i,r){e.warnMsg=!0,e.sucMsg=!0,e.updUserInfo=function(){var s=/^[\u4e00-\u9fa5a-zA-Z0-9_]{1,10}$/g;if(void 0!==e.userInfoForm.userName&&""!==e.userInfoForm.userName&&!s.test(e.userInfoForm.userName))return e.warnMessage=r.registerMsg.name,e.warnMsg=!1,void t.close(".notice",e);var a=/^1[3|4|5|8][0-9]\d{8}$/g;if(""!==e.userInfoForm.dealerPhone&&void 0!==e.userInfoForm.dealerPhone&&!a.test(e.userInfoForm.dealerPhone))return e.warnMessage=r.phoneError,e.warnMsg=!1,void t.close(".notice",e);var u={id:e.userDealer.id,email:e.userDealer.email,userName:e.userInfoForm.userName?e.userInfoForm.userName:e.userDealer.userName,linkman:e.userInfoForm.linkman?e.userInfoForm.linkman:e.userDealer.linkman,dealerPhone:e.userInfoForm.dealerPhone?e.userInfoForm.dealerPhone:e.userDealer.dealerPhone,dealerAddress:e.userInfoForm.dealerAddress?e.userInfoForm.dealerAddress:e.userDealer.dealerAddress};o.updateSubordinate(u).success(function(o){200===o.code?(e.successMessage=o.msg,e.sucMsg=!1,t.close("#editUserInfo",e),e.$emit("dealerData",u),"我的信息"===e.messageType&&(n.userDealer.userName=u.userName)):408===o.code?(e.warnMessage=r.loginGetaway,t.close("#editUserInfo",e),i.path(e)):(e.warnMessage=o.msg,e.warnMsg=!1,t.close("#editUserInfo",e))}).error(function(){e.warnMessage=r.serviceException,e.warnMsg=!1,t.close("#editUserInfo",e)})},e.$on("$destroy",function(){t.cancel(),i.cancel()})}]);var head=angular.module("watchApp.head",[]);head.controller("headCtrl",["$scope","authService","$location","confirmService","$window",function(e,n,o,t,i){e.logOut=function(){t.openConfirmWindow(e,"确认退出吗？").then(function(){i.sessionStorage.removeItem("equipInfo"),n.signOut().success(function(e){200===e.code&&o.path("/login")})})},e.isActive=o.url()}]);var login=angular.module("watchApp.login",[]);login.config(["$routeProvider",function(e){e.when("/login",{templateUrl:"login/login.html"})}]),login.controller("loginCtrl",["$scope","authService","$location","uuid","$timeout","errorMsg","$window",function(e,n,o,t,i,r,s){e.warnMsg=!0,e.sucMsg=!0,e.signInData={},e.signInData.email=s.localStorage.email,void 0!==e.signInData.email&&(e.remember=!0),e.signIn=function(){e.signInData.cid=t,n.signIn(e.signInData).success(function(n){if(200===n.code){o.url("/customer");var t=s.localStorage;e.remember?t.email=e.signInData.email:t.removeItem("email")}else{e.warnMessage=n.msg,e.warnMsg=!1;var r=i(function(){e.warnMsg=!0,i.cancel(r)},1500)}}).error(function(){e.warnMessage=r.serviceException,e.warnMsg=!1;var n=i(function(){e.warnMsg=!0,i.cancel(n)},1500)})}}]);var baiduMap=angular.module("watchApp.baiduMap",[]);baiduMap.controller("baiduMapCtrl",["$scope","$filter","$interval",function(e,n,o){e.map=new BMap.Map("baiduContainer"),e.point=new BMap.Point(114.026033,22.559138),e.map.centerAndZoom(e.point,14),e.map.enableScrollWheelZoom(),e.map.addControl(new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE,enableGeolocation:!0})),e.map.addControl(new BMap.CityListControl({anchor:BMAP_ANCHOR_TOP_LEFT,offset:new BMap.Size(70,20)})),e.map.addControl(new BMap.GeolocationControl),e.map.addControl(new BMap.ScaleControl),e.map.addControl(new BMap.OverviewMapControl),e.map.addControl(new BMap.MapTypeControl),e.map.setCurrentCity("深圳"),e.pointCoordinate={},e.timer=null,e.setTimer=function(n){var t=15;o.cancel(e.timer);var i=new BMap.CopyrightControl({anchor:BMAP_ANCHOR_TOP_LEFT,offset:new BMap.Size(200,20)});e.map.addControl(i);var r='\n            <p style="background: #fff;padding: 5px"><span style="color: #f00">'+t+" </span>秒后刷新!</p>\n        ";i.addCopyright({id:1,content:r}),e.timer=o(function(){r='\n                <p style="background: #fff;padding: 5px"><span style="color: #f00">'+--t+" </span>秒后刷新!</p>\n            ",i.addCopyright({id:1,content:r}),t<0&&(o.cancel(e.timer),e.map.removeControl(i),e.setTimer(n),e.$emit("freshQuery",n))},1e3)},e.map.addEventListener("click",function(n){var o=n.point;(new BMap.Geocoder).getLocation(o,function(n){if(void 0===n&&null===n)return!1;var o=n.addressComponents,t=o.province+o.city+o.district+o.street+o.streetNumber;e.$emit("getAddress",t)})}),e.map.addEventListener("dragend",function(n){if(e.isCenterFlag){if(void 0===e.pointCoordinate.lng)return!1;e.map.centerAndZoom(new BMap.Point(e.pointCoordinate.lng,e.pointCoordinate.lat),14),e.map.disableInertialDragging()}}),e.map.addEventListener("zoomend",function(n){if(e.isCenterFlag){if(void 0===e.pointCoordinate.lng)return!1;e.map.panTo(new BMap.Point(e.pointCoordinate.lng,e.pointCoordinate.lat))}}),e.createMark=function(o){var t=o.online?"../assets/images/online.png":"../assets/images/offline.png";if(void 0!==o.lat){var i=[],r=new BMap.Point(o.lng,o.lat);i.push(r),(new BMap.Convertor).translate(i,1,5,function(i){if(0===i.status){o.lng=i.points[0].lng,o.lat=i.points[0].lat;var r=new BMap.Point(o.lng,o.lat),s=new BMap.Marker(r,{icon:new BMap.Icon(t,new BMap.Size(32,41))}),a=new BMap.Label(o.name,{offset:new BMap.Size(37,6)});a.setStyle({color:"#666",borderColor:"#ffa423",fontSize:"12px",height:"20px",lineHeight:"0",fontFamily:"微软雅黑",maxWidth:"none",padding:"10px"});var u={enableMessage:!0},l="\n                    <p>"+n("returnEmptyStr")(o.name)+"</p>\n                    <p>IMEI号："+n("returnEmptyStr")(o.imei)+"</p>\n                    <p>状态："+(o.online?"在线":"离线")+"</p>\n                    <p>电量："+(o.online?n("returnEmptyStr")(o.electricity)+"%":"")+"</p>\n                    <p>定位时间："+n("returnEmptyStr")(o.locationTime)+"</p>\n                ";e.map.addOverlay(s),s.setLabel(a),s.setAnimation(BMAP_ANIMATION_DROP),o.isActive&&(e.map.openInfoWindow(new BMap.InfoWindow(l,u),r),e.pointCoordinate.lng=o.lng,e.pointCoordinate.lat=o.lat),s.addEventListener("click",function(n){var t=n.target;e.pointCoordinate.lng=t.getPosition().lng,e.pointCoordinate.lat=t.getPosition().lat,e.map.openInfoWindow(new BMap.InfoWindow(l,u),r),e.isCenterFlag&&(e.map.panTo(new BMap.Point(e.pointCoordinate.lng,e.pointCoordinate.lat)),e.map.disableInertialDragging()),e.$emit("makerClick",o)})}})}},e.$on("showNameFlag",function(e,n){angular.element(".BMap_Marker .BMapLabel").css("display",n?"block":"none")}),e.$on("clockCenterFlag",function(n,o){if(e.isCenterFlag=o,o){if(void 0===e.pointCoordinate.lng)return!1;e.map.panTo(new BMap.Point(e.pointCoordinate.lng,e.pointCoordinate.lat)),e.map.disableInertialDragging()}else e.pointCoordinate={},e.map.enableInertialDragging()}),e.$on("currentEquips",function(n,o){var t=angular.copy(o);if(e.setTimer(t),void 0===t.customer&&null===t.customer)return!1;if(e.map.clearOverlays(),angular.forEach(t.customer.equips,function(n,o){e.createMark(n)}),void 0!==t.currentEquip&&null!==t.currentEquip){if(void 0===t.currentEquip.lng)return e.$emit("errorInfo",{msg:"没有坐标信息"}),!1;var i=[],r=new BMap.Point(t.currentEquip.lng,t.currentEquip.lat);i.push(r),(new BMap.Convertor).translate(i,1,5,function(n){0===n.status&&(e.map.panTo(new BMap.Point(n.points[0].lng,n.points[0].lat)),(new BMap.Geocoder).getLocation({lng:t.currentEquip.lng,lat:t.currentEquip.lat},function(n){if(void 0===n||null===n)return!1;var o=n.addressComponents,t=o.province+o.city+o.district+o.street+o.streetNumber;e.$emit("getAddress",t)}))})}else e.pointCoordinate={}}),e.$on("$destroy",function(){o.cancel(e.timer)})}]);var x_PI=52.35987755982988,PI=3.141592653589793,a=6378245,ee=.006693421622965943,googleMap=angular.module("watchApp.googleMap",[]);googleMap.controller("googleMapCtrl",["$scope","$filter","$timeout","$interval",function(e,n,o,t){e.point={lat:22.560118,lng:114.004252},e.map=new google.maps.Map(document.getElementById("googleContainer"),{center:e.point,zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},mapTypeControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},streetViewControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},scaleControl:!0}),e.createRefresh=function(n){var o=document.getElementById("refreshDiv");o&&o.parentNode.removeChild(o);var t=document.createElement("div");t.id="refreshDiv";var i=document.createElement("p"),r=document.createElement("span");r.id="refreshTime",r.style.color="#f00",r.innerHTML=n,i.appendChild(r),i.style.background="#fff",i.style.padding="5px",i.style.marginTop="20px",i.innerHTML=i.innerHTML+"秒后刷新!",t.appendChild(i),e.map.controls[google.maps.ControlPosition.TOP_LEFT].push(t)},e.timer=null,e.setTimer=function(n){var o=15;t.cancel(e.timer),e.createRefresh(o),e.timer=t(function(){o--;var i=document.getElementById("refreshDiv");i?document.getElementById("refreshTime").innerHTML=o:t.cancel(e.timer),o<0&&(t.cancel(e.timer),i&&i.parentNode.removeChild(i),e.setTimer(n),e.$emit("freshQuery",n))},1e3)},e.map.addListener("click",function(n){e.getAddress(n)}),e.getAddress=function(n){(new google.maps.Geocoder).geocode({location:n.latLng},function(n,o){o===google.maps.GeocoderStatus.OK&&e.$emit("getAddress",n[0].formatted_address)})},e.map.addListener("idle",function(){if(e.isCenterFlag){if(void 0===e.pointCoordinate.lng)return!1;e.map.panTo(e.pointCoordinate)}}),e.pointCoordinate={},e.mapMakers=[],e.createMark=function(t){var i=t.online?"../assets/images/online.png":"../assets/images/offline.png";if(void 0!==t.lat){t.lat=Number(t.lat),t.lng=Number(t.lng);var r=wgs84togcj02(t.lng,t.lat);t.lng=r[0],t.lat=r[1];var s=new google.maps.Marker({position:{lat:t.lat,lng:t.lng},icon:i,animation:google.maps.Animation.DROP,map:e.map}),a="\n             <p>"+n("returnEmptyStr")(t.name)+"</p>\n            <p>IMEI号："+n("returnEmptyStr")(t.imei)+"</p>\n            <p>状态："+(t.online?"在线":"离线")+"</p>\n            <p>电量："+(t.online?n("returnEmptyStr")(t.electricity)+"%":"")+"</p>\n            <p>定位时间："+n("returnEmptyStr")(t.locationTime)+"</p>\n        ",u=new google.maps.InfoWindow({content:a});if(e.mapMakers.push(s),new InfoBox({content:t.name,disableAutoPan:!1,maxWidth:0,pixelOffset:new google.maps.Size(20,-35),zIndex:null,boxStyle:{opacity:1,width:"auto",border:"1px solid rgb(255, 164, 35)",padding:"5px 10px",fontSize:"12px",background:"#fff"},closeBoxMargin:"10px 2px 2px 2px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:!1,pane:"floatPane",enableEventPropagation:!1}).open(e.map,s),t.isActive){var l=o(function(){u.open(e.map,s),o.cancel(l)},1);e.pointCoordinate.lng=t.lng,e.pointCoordinate.lat=t.lat}s.addListener("click",function(n){angular.element(".gm-style-iw").parent().css("display","none"),u.open(e.map,s),e.pointCoordinate.lng=n.latLng.lng(),e.pointCoordinate.lat=n.latLng.lat(),e.isCenterFlag&&e.map.panTo(e.pointCoordinate),e.$emit("makerClick",t),e.getAddress(n)})}},e.$on("showNameFlag",function(e,n){angular.element(".infoBox").css("display",n?"block":"none")}),e.$on("clockCenterFlag",function(n,o){if(e.isCenterFlag=o,o){if(void 0===e.pointCoordinate.lng)return!1;e.map.panTo(e.pointCoordinate)}else e.pointCoordinate={}}),e.$on("currentEquips",function(n,o){var t=angular.copy(o);if(e.setTimer(t),void 0===t.customer&&null===t.customer)return!1;if(e.mapMakers.length>0&&angular.forEach(e.mapMakers,function(e,n){e.setMap(null)}),e.mapMakers.length=0,void 0!==t.customer.equips&&angular.forEach(t.customer.equips,function(n,o){e.createMark(n)}),void 0!==t.currentEquip&&null!==t.currentEquip){if(void 0===t.currentEquip.lng)return e.$emit("errorInfo",{msg:"没有坐标信息"}),!1;(new google.maps.Geocoder).geocode({location:{lat:t.currentEquip.lat,lng:t.currentEquip.lng}},function(n,o){o===google.maps.GeocoderStatus.OK&&e.$emit("getAddress",n[0].formatted_address)})}else e.pointCoordinate={}}),e.$on("$destroy",function(){t.cancel(e.timer)})}]),InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var e,n=this,o=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()};this.div_||(this.div_=document.createElement("div"),this.setBoxStyle_(),void 0===this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(e=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-e.left-e.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),this.enableEventPropagation_||(this.eventListener1_=google.maps.event.addDomListener(this.div_,"mousedown",o),this.eventListener2_=google.maps.event.addDomListener(this.div_,"click",o),this.eventListener3_=google.maps.event.addDomListener(this.div_,"dblclick",o),this.eventListener4_=google.maps.event.addDomListener(this.div_,"mouseover",function(e){this.style.cursor="default"})),this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",function(e){e.returnValue=!1,e.preventDefault&&e.preventDefault(),n.enableEventPropagation_||o(e)}),google.maps.event.trigger(this,"domready"))},InfoBox.prototype.getCloseBoxImg_=function(){var e="";return""!==this.closeBoxURL_&&(e="<img",e+=" src='"+this.closeBoxURL_+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin_+";",e+="'>"),e},InfoBox.prototype.addClickHandler_=function(){var e;""!==this.closeBoxURL_?(e=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(e,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var e=this;return function(n){n.cancelBubble=!0,n.stopPropagation&&n.stopPropagation(),e.close(),google.maps.event.trigger(e,"closeclick")}},InfoBox.prototype.panBox_=function(e){var n,o=0,t=0;if(!e&&(n=this.getMap())instanceof google.maps.Map){n.getBounds().contains(this.position_)||n.setCenter(this.position_),n.getBounds();var i=n.getDiv(),r=i.offsetWidth,s=i.offsetHeight,a=this.pixelOffset_.width,u=this.pixelOffset_.height,l=this.div_.offsetWidth,c=this.div_.offsetHeight,d=this.infoBoxClearance_.width,p=this.infoBoxClearance_.height,m=this.getProjection().fromLatLngToContainerPixel(this.position_);if(m.x<-a+d?o=m.x+a-d:m.x+l+a+d>r&&(o=m.x+l+a+d-r),this.alignBottom_?m.y<-u+p+c?t=m.y+u-p-c:m.y+u+p>s&&(t=m.y+u+p-s):m.y<-u+p?t=m.y+u-p:m.y+c+u+p>s&&(t=m.y+c+u+p-s),0!==o||0!==t){n.getCenter();n.panBy(o,t)}}},InfoBox.prototype.setBoxStyle_=function(){var e,n;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",n=this.boxStyle_;for(e in n)n.hasOwnProperty(e)&&(this.div_.style[e]=n[e]);void 0!==this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var e,n={top:0,bottom:0,left:0,right:0},o=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(e=o.ownerDocument.defaultView.getComputedStyle(o,""))&&(n.top=parseInt(e.borderTopWidth,10)||0,n.bottom=parseInt(e.borderBottomWidth,10)||0,n.left=parseInt(e.borderLeftWidth,10)||0,n.right=parseInt(e.borderRightWidth,10)||0):document.documentElement.currentStyle&&o.currentStyle&&(n.top=parseInt(o.currentStyle.borderTopWidth,10)||0,n.bottom=parseInt(o.currentStyle.borderBottomWidth,10)||0,n.left=parseInt(o.currentStyle.borderLeftWidth,10)||0,n.right=parseInt(o.currentStyle.borderRightWidth,10)||0),n},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var e=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=e.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(e.y+this.pixelOffset_.height)+"px":this.div_.style.top=e.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"},InfoBox.prototype.setOptions=function(e){void 0!==e.boxClass&&(this.boxClass_=e.boxClass,this.setBoxStyle_()),void 0!==e.boxStyle&&(this.boxStyle_=e.boxStyle,this.setBoxStyle_()),void 0!==e.content&&this.setContent(e.content),void 0!==e.disableAutoPan&&(this.disableAutoPan_=e.disableAutoPan),void 0!==e.maxWidth&&(this.maxWidth_=e.maxWidth),void 0!==e.pixelOffset&&(this.pixelOffset_=e.pixelOffset),void 0!==e.alignBottom&&(this.alignBottom_=e.alignBottom),void 0!==e.position&&this.setPosition(e.position),void 0!==e.zIndex&&this.setZIndex(e.zIndex),void 0!==e.closeBoxMargin&&(this.closeBoxMargin_=e.closeBoxMargin),void 0!==e.closeBoxURL&&(this.closeBoxURL_=e.closeBoxURL),void 0!==e.infoBoxClearance&&(this.infoBoxClearance_=e.infoBoxClearance),void 0!==e.isHidden&&(this.isHidden_=e.isHidden),void 0!==e.enableEventPropagation&&(this.enableEventPropagation_=e.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(e){this.content_=e,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),void 0===e.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+e:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(e)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px",void 0===e.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+e:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(e))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(e){this.position_=e,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(e){this.zIndex_=e,this.div_&&(this.div_.style.zIndex=e),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(e,n){var o=this;n&&(this.position_=n.getPosition(),this.moveListener_=google.maps.event.addListener(n,"position_changed",function(){o.setPosition(this.getPosition())})),this.setMap(e),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListener1_&&(google.maps.event.removeListener(this.eventListener1_),google.maps.event.removeListener(this.eventListener2_),google.maps.event.removeListener(this.eventListener3_),google.maps.event.removeListener(this.eventListener4_),this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.eventListener4_=null),this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)};var transferEquip=angular.module("watchApp.moveEquip",[]);transferEquip.controller("moveEquipCtrl",["$scope","library","closeWind","pathLogin","errorMsg","dealer",function(e,n,o,t,i,r){e.warnMsg=!0,e.sucMsg=!0,e.dropDown=function(n){n.stopPropagation(),e.$emit("modalTransfer",{event:n})},e.$on("batchTransModal",function(n,o){e.aimCustomer=o.userName,e.aimCusId=o.userId}),e.$on("batchEquipsInfo",function(n,s){s.equips.forEach(function(n,s){void 0!==n.userId&&r.queryById(n.userId).success(function(r){200===r.code&&void 0!==r.result?n.dealerName=r.result.userName:408===r.code?(e.warnMessage=i.loginGetaway,o.close("#moveEquip",e),t.path(e)):(e.warnMessage=r.result?r.msg:i.queryEmpty,e.warnMsg=!1,o.close("#moveEquip",e))}).error(function(){e.warnMessage=i.serviceException,e.warnMsg=!1,o.close("#moveEquip",e)})}),e.equips=s.equips,e.currentUser=s.userId}),e.del=function(n){e.equips.splice(n,1)},e.pushEquip=function(){""!==e.imeiNumber&&void 0!==e.imeiNumber||(e.warnMessage=i.imeiError.imeiEmpty,e.warnMsg=!1,o.close(".notice",e)),n.queryByImei(e.imeiNumber).success(function(n){200===n.code&&void 0!==n.result?e.queryById(n.result):408===n.code?t.path(e):(e.warnMessage=n.result?n.msg:i.queryEmpty,e.warnMsg=!1,o.close(".notice",e))}).error(function(){e.warnMessage=i.serviceException,e.warnMsg=!1,o.close("#moveEquip",e)})},e.queryById=function(n){if(""===n.userId||void 0===n.userId)return e.equips.push(n),!1;r.queryById(n.userId).success(function(r){200===r.code&&void 0!==r.result?(n.dealerName=r.result.userName,e.equips.push(n)):408===r.code?(e.warnMessage=i.loginGetaway,o.close("#moveEquip",e),t.path(e)):(e.warnMessage=r.result?r.msg:i.queryEmpty,e.warnMsg=!1,o.close(".notice",e))}).error(function(){e.warnMessage=i.serviceException,e.warnMsg=!1,o.close("#moveEquip",e)})},e.transEquip=function(){if(void 0===e.aimCustomer||""===e.aimCustomer)return e.warnMessage=i.aimEmpty,e.warnMsg=!1,o.close(".notice",e),!1;if(0===e.equips.length)return e.warnMessage=i.equipEmpty,e.warnMsg=!1,o.close(".notice",e),!1;var r={ids:[],newDealerId:e.aimCusId};if(parseInt(e.currentUser)===parseInt(e.aimCusId))return e.$emit("transformEquip",{msg:i.duplication,sign:!1}),!1;e.equips.forEach(function(e,n){r.ids.push(e.id)}),n.batchTransform(r).success(function(n){200===n.code?e.$emit("transformEquip",{msg:n.msg,sign:n.successful,ids:r.ids}):408===n.code?t.path(e):(e.warnMessage=n.msg,e.warnMsg=!1,o.close(".notice",e)),o.close("#moveEquip",e)}).error(function(){e.warnMessage=i.serviceException,e.warnMsg=!1,o.close("#moveEquip",e)})}}]);var personalInfo=angular.module("watchApp.personal",[]);personalInfo.controller("personalCtrl",["$scope","userInfo","closeWind","pathLogin","reloadRoute","errorMsg",function(e,n,o,t,i,r){e.warnMsg=!0,e.sucMsg=!0,e.updPersonal=function(){var s=/^[\u4e00-\u9fa5a-zA-Z0-9_]{1,10}$/g;if(void 0!==e.personalForm.userName&&""!==e.personalForm.userName&&!s.test(e.personalForm.userName))return e.warnMessage=r.registerMsg.name,e.warnMsg=!1,void o.close(".notice",e);var a=/^1[3|4|5|8][0-9]\d{8}$/g;if(""!==e.personalForm.dealerPhone&&void 0!==e.personalForm.dealerPhone&&!a.test(e.personalForm.dealerPhone))return e.warnMessage=r.phoneError,e.warnMsg=!1,void o.close(".notice",e);var u={email:e.userAdmin.email,userName:e.personalForm.userName,linkman:e.personalForm.linkman,dealerPhone:e.personalForm.dealerPhone,dealerAddress:e.personalForm.dealerAddress};n.update(u).success(function(n){200===n.code?(e.successMessage=n.msg,e.sucMsg=!1,o.close("#personalInfo",e),i.path(e)):408===n.code?(e.warnMessage=r.loginGetaway,o.close("#personalInfo",e),t.path(e)):(e.warnMessage=n.msg,e.warnMsg=!1,o.close("#personalInfo",e))}).error(function(){e.warnMessage=r.serviceException,e.warnMsg=!1,o.close("#personalInfo",e)})},e.$on("$destroy",function(){o.cancel(),t.cancel(),i.cancel()})}]);var position=angular.module("watchApp.position",["ngRoute"]);position.config(["$routeProvider",function(e){e.when("/position",{templateUrl:"position/position.html"}).when("/position/:email",{templateUrl:"position/position.html"}).otherwise({redirectTo:"position/position.html"})}]),position.controller("positionCtrl",["$rootScope","$scope","indexService","loginGetaway","$routeParams","$window","errorMsg","ordinaryMsg","location","$timeout",function(e,n,o,t,i,r,s,a,u,l){n.mapChoose="baidu",n.showName=!0,n.isFold=!1,n.iconActive={},n.loading=!0,e.userAdmin=null,n.dealerInfo=null;var c=angular.element("#listContainer"),d=angular.element("#mapContainer");if(c.height(document.documentElement.clientHeight-170),d.height(document.documentElement.clientHeight-170),n.getEquipInfo=function(){o.indexData().success(function(o){200===o.code&&(e.userAdmin=o.result.userInfoDTO,u.queryEquipNum(e.userAdmin.id).success(function(e){if(200===e.code)if(r.sessionStorage.equipInfo=JSON.stringify({initData:e.result,time:(new Date).getTime(),userAdmin:o.result.userInfoDTO}),n.dealerInfo=e.result?e.result:[],void 0!==i.email)var s=l(function(){n.searchCustomers(i.email),l.cancel(s)},1);else n.loading=!1;408===e.code&&t.goLogin()}).error(function(){n.loading=!1,n.msgModal=s.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")})),408===o.code&&(n.loading=!1,t.goLogin())}).error(function(){n.loading=!1,t.goLogin()})},void 0===r.sessionStorage.equipInfo)n.getEquipInfo();else{var p=(new Date).getTime(),m=JSON.parse(r.sessionStorage.equipInfo);if(m.time+1e4>p){if(e.userAdmin=m.userAdmin,n.dealerInfo=m.initData,n.loading=!1,void 0!==i.email)var g=l(function(){n.searchCustomers(i.email),l.cancel(g)},1)}else n.getEquipInfo()}n.mapChooseChg=function(){n.clockCenter=!1,n.showName=!0,n.detailAddress="",n.dealerInfo.forEach(function(e,n){e.isActive=!1,void 0!==e.equips&&e.equips.forEach(function(e,n){e.isActive=!1})})},n.searchEquips=function(e){n.loading=!0;var o={info:e||n.searchParams};/(^[\d]{10}$)|(^[\d]{15}$)/g.test(o.info)?u.queryByImei(o.info).success(function(e){n.searchByInfo(e,o.info)}).error(function(){n.loading=!1,n.msgModal=s.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")}):u.queryByName(o.info).success(function(e){n.searchByInfo(e,o.info)}).error(function(){n.loading=!1,n.msgModal=s.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")})},n.searchByInfo=function(e,o){if(null===e)return!1;if(n.loading=!1,200===e.code){var i=e.result;void 0!==i.equips&&i.equips.forEach(function(e,n){if(e.imei===o){e.isActive=!0;var t=[];t.push(e),i.equips=t}}),n.$broadcast("currentEquips",{customer:i,currentEquip:i.equips[0]}),n.dealerInfo.forEach(function(e,n){e.isActive=e.userName===i.userName,void 0!==e.equips&&e.equips.forEach(function(e,n){e.isActive=e.imei===o})})}else 408===e.code?t.goLogin():(n.msgModal=e.msg,angular.element(".bs-example-modal-sm").modal("toggle"))},n.searchCustomers=function(e){var o={info:e||n.searchParams};n.loading=!0,u.queryByEmail(o).success(function(e){if(200===e.code){var o=e.result;n.loading=!1,n.$broadcast("currentEquips",{customer:o}),n.dealerInfo.forEach(function(e,n){e.isActive=e.userName===o.userName,void 0!==e.equips&&e.equips.forEach(function(e,n){e.isActive=!1})})}else 408===e.code?t.goLogin():(n.loading=!1,n.msgModal=e.msg,angular.element(".bs-example-modal-sm").modal("toggle"))}).error(function(){n.loading=!1,n.msgModal=s.serviceException,angular.element(".bs-example-modal-sm").modal("toggle")})},n.collapseClick=function(e,o,t){e&&e.preventDefault?e.preventDefault():window.event.returnValue=!1,n.searchCustomers(o),n.dealerInfo.forEach(function(e,n){e.isActive=e.userName===o,void 0!==e.equips&&e.equips.forEach(function(e,n){e.isActive=!1})}),n.iconActive[t]=e.target.getAttribute("aria-expanded")},n.equipChoose=function(e){n.searchEquips(e),n.detailAddress=""},n.operatMenu=function(e){"close"===e?(angular.element(".customer-list-head").animate({width:0},function(){n.$apply(function(){n.isFold=!0})}),angular.element(".position-map").animate({width:"98%"})):(angular.element(".customer-list-head").animate({width:"16.66666667%"},function(){n.$apply(function(){n.isFold=!1})}),angular.element(".position-map").animate({width:"83.33333333%"}))},n.isShowName=function(e){n.$broadcast("showNameFlag",e)},n.isClockCenter=function(e){n.$broadcast("clockCenterFlag",e)},n.$on("getAddress",function(e,o){n.$apply(function(){n.detailAddress=o})}),n.$on("makerClick",function(e,o){n.$apply(function(){n.dealerInfo.forEach(function(e,n){e.isActive=!1,void 0!==e.equips&&e.equips.forEach(function(e,n){e.isActive=e.name===o.name})})})}),n.$on("errorInfo",function(e,o){n.msgModal=o.msg,angular.element(".bs-example-modal-sm").modal("toggle")}),n.$on("freshQuery",function(e,o){void 0!==o.currentEquip&&null!==o.currentEquip?n.searchEquips(o.currentEquip.imei):n.searchCustomers(o.customer.userName)})}]),position.filter("returnEmptyStr",function(){return function(e){return void 0===e||null===e?"":e}});var rightMenu=angular.module("watchApp.rightMenu",[]);rightMenu.controller("rightMenuCtrl",["$scope","dealer","pathLogin","errorMsg","confirmService",function(e,n,o,t,i){e.rightMenuList={addCus:"新增客户",resetPwd:"重置密码",delCus:"删除客户",editInfo:"编辑信息"},e.$on("dealerMsg",function(n,o){e.dealerInfo=o||{}}),e.menuFun=function(r){switch(r){case"addCus":angular.element("#addCustomer").modal("toggle");break;case"resetPwd":if(void 0===e.dealerInfo.userId)return!1;i.openConfirmWindow(e,"确定重置密码吗？").then(function(){n.resetPwd(e.dealerInfo.userId).success(function(n){408===n.code?o.path(e):e.$emit("transformEquip",{msg:n.msg,sign:!1})}).error(function(){e.$emit("transformEquip",{msg:t.serviceException,sign:!1})})});break;case"delCus":if(void 0===e.dealerInfo.userId||e.dealerInfo.equipNum>0)return e.$emit("transformEquip",{msg:t.delFail,sign:!1}),!1;i.openConfirmWindow(e,"确定删除客户吗？").then(function(){n.delCus(e.dealerInfo.userId).success(function(n){408===n.code?o.path(e):e.$emit("transformEquip",{msg:n.msg,sign:!0,func:"delCus"})}).error(function(){e.$emit("transformEquip",{msg:t.serviceException,sign:!1})})});break;case"editInfo":angular.element("#showCustomer").modal("toggle")}}}]);var searchEquips=angular.module("watchApp.searchEquips",[]);searchEquips.controller("searchEquipsCtrl",["$scope","library","closeWind","pathLogin","ordinaryMsg","errorMsg","loginGetaway","dealer","$location","$timeout",function(e,n,o,t,i,r,s,a,u,l){e.warnMsg=!0,e.sucMsg=!0,e.recordNum=0,e.$on("equipInfo",function(n,o){e.customer=void 0,e.equip=o,e.recordNum=o?1:0,void 0!==o.dealerId&&e.searchDealerSub(o.dealerId)}),e.searchDealerSub=function(n){a.queryById(n).success(function(n){200===n.code&&void 0!==n.result?e.customer=n.result:408===n.code?(e.warnMessage=r.loginGetaway,o.close("#searchEquips",e),t.path(e)):(e.warnMessage=n.result?n.msg:r.queryEmpty,e.warnMsg=!1,o.close("#searchEquips",e))}).error(function(){e.warnMessage=r.serviceException,e.warnMsg=!1,o.close("#searchEquips",e)})},e.updateEquip=function(){angular.element("#searchEquips").modal("hide"),angular.element("#updateEquip").modal("toggle"),e.$emit("searchEquip",e.equip)},e.transferCus=function(n,o){n.stopPropagation();var t={event:n,id:o.id};e.$emit("modalTransfer",t)},e.removeEquip=function(o){n.delete(o).success(function(n){var t={msg:null,id:o};200===n.code?(t.msg=i.deleteInfo.success,e.equip=null):408===n.code?s.goLogin():t.msg=i.deleteInfo.failure,e.$emit("delMsg",t),angular.element("#searchEquips").modal("hide"),angular.element(".bs-example-modal-sm").modal("toggle")}).error(function(){e.$emit("delMsg",{msg:r.serviceException,id:null}),angular.element("#searchEquips").modal("hide"),angular.element(".bs-example-modal-sm").modal("toggle")})},e.showCustomer=function(){angular.element("#searchEquips").modal("hide"),angular.element("#showCustomer").modal("toggle"),e.$emit("showCusInfo",e.customer)},e.showPosition=function(){angular.element("#searchEquips").modal("hide");var n=l(function(){u.path("/position/"+e.customer.email),l.cancel(n)},500)}}]);var searchCustomers=angular.module("watchApp.searchCustomers",[]);searchCustomers.controller("searchCustomersCtrl",["$scope","$timeout","$location",function(e,n,o){e.$on("myCustomerInfo",function(n,o){e.cusInfo=o}),e.showCustomer=function(){angular.element("#searchCustomers").modal("hide"),angular.element("#showCustomer").modal("toggle"),e.$emit("showCusInfo",e.cusInfo)},e.showPosition=function(){angular.element("#searchCustomers").modal("hide");var t=n(function(){o.path("/position/"+e.cusInfo.email),n.cancel(t)},500)}}]);var showCustomer=angular.module("watchApp.showCustomer",[]);showCustomer.controller("showCustomerCtrl",["$scope","userInfo","closeWind","pathLogin","errorMsg","dealer",function(e,n,o,t,i,r){e.warnMsg=!0,e.sucMsg=!0,e.$on("customerInfo",function(n,o){e.currentCus=o,e.userInfoForm={}}),e.$on("dealerMsg",function(n,s){var a={info:s.email};r.queryByEmail(a).success(function(n){200===n.code&&void 0!==n.result?e.currentCus=n.result:408===n.code?(e.warnMessage=i.loginGetaway,o.close("#searchCustomers",e),t.path(e)):(e.warnMessage=n.result?n.msg:i.queryEmpty,e.warnMsg=!1,o.close("#searchCustomers",e))}).error(function(){e.warnMessage=i.serviceException,e.warnMsg=!1,o.close("#searchCustomers",e)})}),e.updUserInfo=function(){var r=/^[\u4e00-\u9fa5a-zA-Z0-9_]{1,10}$/g;if(void 0!==e.userInfoForm.userName&&""!==e.userInfoForm.userName&&!r.test(e.userInfoForm.userName))return e.warnMessage=i.registerMsg.name,e.warnMsg=!1,void o.close(".notice",e);var s=/^1[3|4|5|8][0-9]\d{8}$/g;if(""!==e.userInfoForm.dealerPhone&&void 0!==e.userInfoForm.dealerPhone&&!s.test(e.userInfoForm.dealerPhone))return e.warnMessage=i.phoneError,e.warnMsg=!1,void o.close(".notice",e);var a={id:e.currentCus.id,email:e.currentCus.email,userName:e.userInfoForm.userName?e.userInfoForm.userName:e.currentCus.userName,linkman:e.userInfoForm.linkman?e.userInfoForm.linkman:e.currentCus.linkman,dealerPhone:e.userInfoForm.dealerPhone?e.userInfoForm.dealerPhone:e.currentCus.dealerPhone,dealerAddress:e.userInfoForm.dealerAddress?e.userInfoForm.dealerAddress:e.currentCus.dealerAddress};n.updateSubordinate(a).success(function(n){200===n.code?(e.successMessage=n.msg,e.sucMsg=!1,o.close("#showCustomer",e),e.$emit("dealerInfoChange",a)):408===n.code?(e.warnMessage=i.loginGetaway,o.close("#showCustomer",e),t.path(e)):(e.warnMessage=n.msg,e.warnMsg=!1,o.close("#showCustomer",e))}).error(function(){e.warnMessage=i.serviceException,e.warnMsg=!1,o.close("#showCustomer",e)})},e.$on("$destroy",function(){o.cancel(),t.cancel()})}]);var transferCustomer=angular.module("watchApp.transferCustomer",[]);transferCustomer.controller("transferCustomerCtrl",["$scope","library","errorMsg","pathLogin","closeWind",function(e,n,o,t,i){e.allUser=null,e.$on("allUserInfo",function(n,o){e.allUser=o}),e.$on("transformInfo",function(n,o){e.equipId=o.equipId,e.userId=o.userId}),e.customerClick=function(r){var s={id:e.equipId,newDealerId:r.userId};if(void 0===e.equipId)e.$emit("batchTrans",r);else{if(parseInt(r.userId)===parseInt(e.userId))return e.$emit("transformEquip",{msg:o.duplication,sign:!1}),!1;n.transform(s).success(function(n){200===n.code?i.close("#searchEquips",e):408===n.code&&t.path(e),e.$emit("transformEquip",{msg:n.msg,sign:n.successful,ids:[e.equipId]})}).error(function(){e.$emit("transformEquip",{msg:o.serviceException,sign:!1})})}}}]);var updateEquip=angular.module("watchApp.updateEquip",[]);updateEquip.controller("updateEquipCtrl",["$scope","library","closeWind","pathLogin","errorMsg",function(e,n,o,t,i){e.warnMsg=!0,e.sucMsg=!0,e.updEquip=function(){if(/^\d+$/.test(e.equipForm.equipName))return e.warnMessage=i.imeiError.name,e.warnMsg=!1,void o.close(".notice",e);var r=/^1[3|4|5|8][0-9]\d{8}$/g;if(""!==e.equipForm.sim&&void 0!==e.equipForm.sim&&!r.test(e.equipForm.sim))return e.warnMessage=i.phoneError,e.warnMsg=!1,void o.close(".notice",e);var s={imei:e.equip.imei,id:e.equip.id,equipName:e.equipForm.equipName?e.equipForm.equipName:e.equip.equipName,sim:e.equip.sim,remark:e.equipForm.remark?e.equipForm.remark:e.equip.remark,createTime:null,activationTime:null};n.update(s).success(function(n){200===n.code?(e.successMessage=n.msg,e.sucMsg=!1,e.$emit("equipData",s),o.close("#updateEquip",e)):408===n.code?(e.warnMessage=i.loginGetaway,o.close("#updateEquip",e),t.path(e)):(e.warnMessage=n.msg,e.warnMsg=!1,o.close("#updateEquip",e))}).error(function(){e.warnMessage=i.serviceException,e.warnMsg=!1,o.close("#updateEquip",e)})},e.clearPhone=function(){void 0!==e.equip&&n.resetPhone(e.equip.id).success(function(n){200===n.code?(e.successMessage=n.msg,e.sucMsg=!1,e.equip.sim="",o.close("#updateEquip",e)):408===n.code?(e.warnMessage=i.loginGetaway,o.close("#updateEquip",e),t.path(e)):(e.warnMessage=n.msg,e.warnMsg=!1,o.close("#updateEquip",e))}).error(function(){e.warnMessage=i.serviceException,e.warnMsg=!1,o.close("#updateEquip",e)})},e.$on("$destroy",function(){o.cancel(),t.cancel()})}]);var updatePassword=angular.module("watchApp.password",[]);updatePassword.controller("updPswCtrl",["$scope","errorMsg","$location","$timeout","password","closeWind","pathLogin",function(e,n,o,t,i,r,s){e.warnMsg=!0,e.sucMsg=!0,e.errorPassword=n.password,e.updPsw=function(){if(null===e.oldPassword||""===e.oldPassword||null===e.newPassword||""===e.newPassword)return e.warnMessage=e.errorPassword.required,e.warnMsg=!1,void r.close("#updatePassword",e);if(e.oldPassword===e.newPassword)return e.warnMessage=e.errorPassword.same,e.warnMsg=!1,void r.close("#updatePassword",e);if(e.newPassword!==e.affirm)return e.warnMessage=e.errorPassword.diff,e.warnMsg=!1,void r.close("#updatePassword",e);var n={oldPassword:e.oldPassword,newPassword:e.newPassword};i.updatePassword(n).success(function(n){200===n.code?(e.successMessage="修改成功",e.sucMsg=!1,r.close("#updatePassword",e),s.path(e)):408===n.code?(e.warnMsg=n.msg,e.warnMsg=!1,r.close("#updatePassword",e),s.path(e)):(e.warnMessage=n.msg,e.warnMsg=!1,r.close("#updatePassword",e))}).error(function(){e.warnMessage="服务器异常,请联系管理员!",e.warnMsg=!1,r.close("#updatePassword",e)})},e.close=function(){angular.element("#updatePassword").modal("hide")},e.$on("$destroy",function(){r.cancel(),s.cancel()})}]),angular.module("watchApp.version.interpolate-filter",[]).filter("interpolate",["version",function(e){return function(n){return String(n).replace(/\%VERSION\%/gm,e)}}]),angular.module("watchApp.version.version-directive",[]).directive("appVersion",["version",function(e){return function(n,o,t){o.text(e)}}]),angular.module("watchApp.version",["watchApp.version.interpolate-filter","watchApp.version.version-directive"]).value("version","0.1");